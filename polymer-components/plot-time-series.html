<link rel="import" href="../../polymer/polymer.html">

<link rel="import" href="./fotochrom.html">

<dom-module id="plot-time-series">
  <template>
    <style>
      :host {
        display: inline-block;
      }
      :host .container,
      :host .value {
        height: 100%;
        width: 100%;
      }

      :host ::content svg {
        font: 10px sans-serif;
      }

      :host ::content .axis path, :host ::content .axis line {
        fill: none;
        stroke: #000;
        shape-rendering: crispEdges;
      }

      :host ::content .line {
        fill: none;
        stroke: #000;
        stroke-width: 1.5px;
      }

      :host ::content .area {
        fill: #969696;
      }

      :host ::content .attention {
        background: yellow;
        margin: -4px;
        padding: 4px;
      }
    </style>
    <span class='container'>
      <content>
        <span id='value'></span>
      </content>
    </span>
  </template>

  <script>
    Polymer({

      is: 'plot-time-series',

      properties: {
        timeFormat: String
      },

      refresh: function(value) {
        this._chart.refresh(this.$.value, value);
      },

      created: function() {
        let fotochrom = window.fotochrom;
        let chart = new fotochrom.plotTimeSeries();
        // var formatDate = d3.time.format('%b %Y');

        chart
          .setNormaliseXTimeFormat(this.timeFormat)
          .setNormaliseY(function(d) { return +d.price; });
        this._chart = chart;
      }
    });
  </script>
</dom-module>
